[
    {
        "id": "c5b211326b86063d",
        "type": "tab",
        "label": "CONTROL LEDS",
        "disabled": false,
        "info": ""
    },
    {
        "id": "179d8f5634a6312c",
        "type": "mqtt out",
        "z": "c5b211326b86063d",
        "name": "config",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "759329fc13f505d4",
        "x": 570,
        "y": 1020,
        "wires": []
    },
    {
        "id": "0707032f37357952",
        "type": "ui_numeric",
        "z": "c5b211326b86063d",
        "name": "",
        "label": "Comprobación Actualizaciones",
        "tooltip": "",
        "group": "f994c279a8f7d872",
        "order": 2,
        "width": 0,
        "height": 0,
        "wrap": false,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{value}} min",
        "min": 0,
        "max": "100",
        "step": "10",
        "className": "",
        "x": 450,
        "y": 480,
        "wires": [
            [
                "862a4d340e451143"
            ]
        ]
    },
    {
        "id": "8dfa42285029ba09",
        "type": "ui_numeric",
        "z": "c5b211326b86063d",
        "name": "",
        "label": "Periodo Envio Mensajes",
        "tooltip": "",
        "group": "f994c279a8f7d872",
        "order": 1,
        "width": 0,
        "height": 0,
        "wrap": false,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{value}} s",
        "min": 0,
        "max": "500",
        "step": "25",
        "className": "",
        "x": 430,
        "y": 420,
        "wires": [
            [
                "6678ca1d211c6063"
            ]
        ]
    },
    {
        "id": "3764e825ec6c2149",
        "type": "ui_numeric",
        "z": "c5b211326b86063d",
        "name": "",
        "label": "Velocidad cambio",
        "tooltip": "",
        "group": "ec055c1548084946",
        "order": 3,
        "width": 0,
        "height": 0,
        "wrap": false,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{value}}",
        "min": 0,
        "max": "20",
        "step": 1,
        "className": "",
        "x": 410,
        "y": 540,
        "wires": [
            [
                "cad09707ca461af3"
            ]
        ]
    },
    {
        "id": "7742291a6fc4fd1f",
        "type": "debug",
        "z": "c5b211326b86063d",
        "name": "CONFIG",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 1080,
        "wires": []
    },
    {
        "id": "6fc7108801906565",
        "type": "function",
        "z": "c5b211326b86063d",
        "name": "",
        "func": "var envia=global.get(\"envia\")\nvar actualiza=global.get(\"actualiza\")\nvar velocidad=global.get(\"velocidad\")\nvar led=global.get(\"polaridad\")\nvar switches=global.get(\"polaridad\")\nvar idplaca=global.get(\"ChipID\")\nmsg.topic=\"II12/\"+idplaca+\"/config\"\n\nmsg.payload={\"envia\":envia,\"actualiza\":actualiza,\"velocidad\":velocidad,\"LED\":led,\"SWITCH\":switches}\n\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 1020,
        "wires": [
            [
                "7742291a6fc4fd1f",
                "179d8f5634a6312c"
            ]
        ]
    },
    {
        "id": "6678ca1d211c6063",
        "type": "change",
        "z": "c5b211326b86063d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "envia",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 720,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "862a4d340e451143",
        "type": "change",
        "z": "c5b211326b86063d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "actualiza",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "cad09707ca461af3",
        "type": "change",
        "z": "c5b211326b86063d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "velocidad",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "ff634c27d6f7874a",
        "type": "inject",
        "z": "c5b211326b86063d",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "60",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{ }",
        "payloadType": "json",
        "x": 210,
        "y": 1020,
        "wires": [
            [
                "6fc7108801906565"
            ]
        ]
    },
    {
        "id": "26f9547bbd169dfc",
        "type": "inject",
        "z": "c5b211326b86063d",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{ }",
        "payloadType": "json",
        "x": 190,
        "y": 540,
        "wires": [
            [
                "8dfa42285029ba09",
                "0707032f37357952",
                "3764e825ec6c2149"
            ]
        ]
    },
    {
        "id": "4e7a13964d5d9403",
        "type": "change",
        "z": "c5b211326b86063d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "polaridad",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 1400,
        "wires": [
            [
                "d156ffc9e0bf73b1"
            ]
        ]
    },
    {
        "id": "3cbfc7907d1873e6",
        "type": "ui_switch",
        "z": "c5b211326b86063d",
        "name": "",
        "label": "Polaridad",
        "tooltip": "",
        "group": "ec055c1548084946",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 160,
        "y": 1400,
        "wires": [
            [
                "53f45c0641962c04",
                "45f82ed4eb17b477"
            ]
        ]
    },
    {
        "id": "53f45c0641962c04",
        "type": "function",
        "z": "c5b211326b86063d",
        "name": "",
        "func": "var p = msg.payload\nif(p==true)\n    msg.payload=1\nelse\n    msg.payload=0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 1400,
        "wires": [
            [
                "4e7a13964d5d9403",
                "2c6d08edeec65022"
            ]
        ]
    },
    {
        "id": "2c6d08edeec65022",
        "type": "debug",
        "z": "c5b211326b86063d",
        "name": "P2",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 530,
        "y": 1460,
        "wires": []
    },
    {
        "id": "45f82ed4eb17b477",
        "type": "debug",
        "z": "c5b211326b86063d",
        "name": "P1",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 370,
        "y": 1340,
        "wires": []
    },
    {
        "id": "d156ffc9e0bf73b1",
        "type": "debug",
        "z": "c5b211326b86063d",
        "name": "P3",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 830,
        "y": 1400,
        "wires": []
    },
    {
        "id": "5f16e7248a799a4a",
        "type": "mqtt in",
        "z": "c5b211326b86063d",
        "name": "",
        "topic": "II12/+/switch/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "759329fc13f505d4",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 210,
        "y": 240,
        "wires": [
            [
                "e3a61cbcac5bdfe8",
                "efd54f18e7883e64"
            ]
        ]
    },
    {
        "id": "e3a61cbcac5bdfe8",
        "type": "debug",
        "z": "c5b211326b86063d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 490,
        "y": 240,
        "wires": []
    },
    {
        "id": "15375cf4f390a5f5",
        "type": "mqtt in",
        "z": "c5b211326b86063d",
        "name": "",
        "topic": "II12/+/led/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "759329fc13f505d4",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 200,
        "y": 100,
        "wires": [
            [
                "32db0114d552e183",
                "42c5777376d5ab98"
            ]
        ]
    },
    {
        "id": "e4df47a9fab2085a",
        "type": "comment",
        "z": "c5b211326b86063d",
        "name": "Nivel de intensidad actual del LED",
        "info": "",
        "x": 260,
        "y": 60,
        "wires": []
    },
    {
        "id": "9714af625e491af6",
        "type": "ui_text",
        "z": "c5b211326b86063d",
        "group": "ec055c1548084946",
        "order": 4,
        "width": "6",
        "height": "7",
        "name": "",
        "label": "Estado del LED",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "className": "",
        "x": 860,
        "y": 100,
        "wires": []
    },
    {
        "id": "e3191a25e5d00aa6",
        "type": "debug",
        "z": "c5b211326b86063d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 830,
        "y": 40,
        "wires": []
    },
    {
        "id": "32db0114d552e183",
        "type": "json",
        "z": "c5b211326b86063d",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 470,
        "y": 100,
        "wires": [
            [
                "dda6612d92ef127d"
            ]
        ]
    },
    {
        "id": "dda6612d92ef127d",
        "type": "function",
        "z": "c5b211326b86063d",
        "name": "",
        "func": "msg.payload.origen=global.get(\"origen\")\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 640,
        "y": 100,
        "wires": [
            [
                "9714af625e491af6",
                "e3191a25e5d00aa6"
            ]
        ]
    },
    {
        "id": "42c5777376d5ab98",
        "type": "change",
        "z": "c5b211326b86063d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "date"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 160,
        "wires": [
            [
                "4742959f1a695158"
            ]
        ]
    },
    {
        "id": "468d2af615b7e8fc",
        "type": "ui_text",
        "z": "c5b211326b86063d",
        "group": "58cd41ecad3d35cb",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización LED",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "className": "",
        "x": 890,
        "y": 160,
        "wires": []
    },
    {
        "id": "4742959f1a695158",
        "type": "function",
        "z": "c5b211326b86063d",
        "name": "",
        "func": "var fecha = new Date (msg.payload);\n\nmsg.payload = fecha.toLocaleString(\"es-ES\",{\"timeZone\": \"Europe/Madrid\"});\n\nmsg.payload.fecha=fecha\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 680,
        "y": 160,
        "wires": [
            [
                "468d2af615b7e8fc"
            ]
        ]
    },
    {
        "id": "efd54f18e7883e64",
        "type": "change",
        "z": "c5b211326b86063d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "date"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 520,
        "y": 300,
        "wires": [
            [
                "b30cfab054b48dee"
            ]
        ]
    },
    {
        "id": "7e530b6390365c49",
        "type": "ui_text",
        "z": "c5b211326b86063d",
        "group": "58cd41ecad3d35cb",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización Swich",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "className": "",
        "x": 920,
        "y": 300,
        "wires": []
    },
    {
        "id": "b30cfab054b48dee",
        "type": "function",
        "z": "c5b211326b86063d",
        "name": "",
        "func": "var fecha = new Date (msg.payload);\n\nmsg.payload = fecha.toLocaleString(\"es-ES\",{\"timeZone\": \"Europe/Madrid\"});\n\nmsg.payload.fecha=fecha\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 700,
        "y": 300,
        "wires": [
            [
                "7e530b6390365c49"
            ]
        ]
    },
    {
        "id": "ea942f60b14c7c9e",
        "type": "ui_slider",
        "z": "c5b211326b86063d",
        "name": "",
        "label": "Intensidad",
        "tooltip": "",
        "group": "ec055c1548084946",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "outs": "end",
        "topic": "topic",
        "topicType": "msg",
        "min": 0,
        "max": "100",
        "step": 1,
        "className": "",
        "x": 190,
        "y": 800,
        "wires": [
            [
                "4334a7106248b2a4",
                "d0037bafd7729845",
                "6fc7108801906565"
            ]
        ]
    },
    {
        "id": "d0037bafd7729845",
        "type": "function",
        "z": "c5b211326b86063d",
        "name": "",
        "func": "var level=global.get(\"ledlevel\")\nvar idplaca=global.get(\"ChipID\")\nmsg.payload={\"level\":level, \"id\":idplaca}\nmsg.topic=\"II12/\"+idplaca+\"/led/cmd\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 840,
        "wires": [
            [
                "a55130f9734bf972",
                "f671f32a6d049df6"
            ]
        ]
    },
    {
        "id": "6e89c69941ca3db0",
        "type": "comment",
        "z": "c5b211326b86063d",
        "name": "Control Intensidad LED",
        "info": "",
        "x": 140,
        "y": 860,
        "wires": []
    },
    {
        "id": "a55130f9734bf972",
        "type": "mqtt out",
        "z": "c5b211326b86063d",
        "name": "led/cmd",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "759329fc13f505d4",
        "x": 620,
        "y": 840,
        "wires": []
    },
    {
        "id": "f671f32a6d049df6",
        "type": "debug",
        "z": "c5b211326b86063d",
        "name": "LED",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 900,
        "wires": []
    },
    {
        "id": "4334a7106248b2a4",
        "type": "change",
        "z": "c5b211326b86063d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ledlevel",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "origen",
                "pt": "global",
                "to": "mqtt",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "e5e0b2d02a6b9339",
        "type": "change",
        "z": "c5b211326b86063d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "switches",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 1220,
        "wires": [
            [
                "a64b23b60a216a32"
            ]
        ]
    },
    {
        "id": "2ab8335b82a44e98",
        "type": "ui_switch",
        "z": "c5b211326b86063d",
        "name": "",
        "label": "Switch",
        "tooltip": "",
        "group": "58cd41ecad3d35cb",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 150,
        "y": 1220,
        "wires": [
            [
                "e5e0b2d02a6b9339",
                "6fc7108801906565"
            ]
        ]
    },
    {
        "id": "32fd7d557f9be282",
        "type": "mqtt out",
        "z": "c5b211326b86063d",
        "name": "switch/cmd",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "23439890538676f0",
        "x": 830,
        "y": 1220,
        "wires": []
    },
    {
        "id": "83a322a22c435e63",
        "type": "debug",
        "z": "c5b211326b86063d",
        "name": "SWITCH",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 820,
        "y": 1280,
        "wires": []
    },
    {
        "id": "a64b23b60a216a32",
        "type": "function",
        "z": "c5b211326b86063d",
        "name": "",
        "func": "var level=global.get(\"switches\")\nvar idplaca=global.get(\"ChipID\")\nmsg.payload={\"level\":level, \"id\":idplaca}\nmsg.topic=\"II12/\"+idplaca+\"/switch/cmd\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 1220,
        "wires": [
            [
                "83a322a22c435e63",
                "32fd7d557f9be282"
            ]
        ]
    },
    {
        "id": "759329fc13f505d4",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "f994c279a8f7d872",
        "type": "ui_group",
        "name": "Configuraciones",
        "tab": "9e135a2423bbe1e2",
        "order": 1,
        "disp": true,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "ec055c1548084946",
        "type": "ui_group",
        "name": "Configuración del LED",
        "tab": "9e135a2423bbe1e2",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "58cd41ecad3d35cb",
        "type": "ui_group",
        "name": "Actuadores",
        "tab": "9e135a2423bbe1e2",
        "order": 2,
        "disp": true,
        "width": "5",
        "collapse": false,
        "className": ""
    },
    {
        "id": "23439890538676f0",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "9e135a2423bbe1e2",
        "type": "ui_tab",
        "name": "Configuración del Dispositivo",
        "icon": "dashboard",
        "order": 2,
        "disabled": false,
        "hidden": false
    }
]
